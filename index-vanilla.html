<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jay's Mobile Wash - Premium McLaren-Level Car Detailing Service</title>
    <meta name="description" content="Jay's Mobile Wash offers professional mobile car detailing with foam cannon technology. McLaren certified experts. Book your premium wash today!">
    <meta name="keywords" content="car wash, mobile detailing, foam cannon, McLaren detailing, professional car wash, Jay's wash">
    <meta name="author" content="Jay's Mobile Wash">
    <meta name="robots" content="index, follow">
    <meta name="googlebot" content="index, follow">
    <meta name="geo.region" content="US-CA">
    <meta name="geo.placename" content="Los Angeles">
    <meta name="geo.position" content="34.0522;-118.2437">
    <meta name="ICBM" content="34.0522, -118.2437">
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://jaysmobilewash.net/">
    <meta property="og:title" content="Jay's Mobile Wash - McLaren-Level Detailing">
    <meta property="og:description" content="Premium mobile car detailing with foam cannon technology. Professional service at your location.">
    <meta property="og:image" content="https://jaysmobilewash.net/og-image.jpg">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    <meta property="og:locale" content="en_US">
    <meta property="og:site_name" content="Jay's Mobile Wash">
    
    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="@jaysmobilewash">
    <meta name="twitter:creator" content="@jaysmobilewash">
    <meta name="twitter:title" content="Jay's Mobile Wash - Premium Car Detailing">
    <meta name="twitter:description" content="McLaren-certified mobile detailing at your location">
    <meta name="twitter:image" content="https://jaysmobilewash.net/twitter-card.jpg">
    
    <!-- Additional SEO -->
    <link rel="canonical" href="https://jaysmobilewash.net/">
    <link rel="alternate" hreflang="en" href="https://jaysmobilewash.net/">
    <link rel="alternate" hreflang="es" href="https://jaysmobilewash.net/es/">
    
    <!-- Preconnect to optimize performance -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="preconnect" href="https://cdn.jaysmobilewash.net">
    <link rel="dns-prefetch" href="https://www.google-analytics.com">
    
    <!-- Preload critical resources -->
    <link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" crossorigin>
    
    <!-- Load fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
    
    <style>
        /* Critical CSS - Inline for fastest render */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary-color: #FF6B35;
            --secondary-color: #2C3E50;
            --accent-color: #3498DB;
            --text-color: #333;
            --bg-color: #0A0E27;
            --particle-color: #00D4FF;
            --foam-color: #FFFFFF;
            --success-color: #2ECC71;
            --warning-color: #F1C40F;
            --error-color: #E74C3C;
        }

        /* Performance optimizations */
        .gpu {
            transform: translateZ(0);
            will-change: transform;
            backface-visibility: hidden;
            perspective: 1000px;
        }

        .contain-paint {
            contain: paint;
        }

        .contain-layout {
            contain: layout;
        }

        .contain-strict {
            contain: strict;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: var(--bg-color);
            color: var(--text-color);
            overflow-x: hidden;
            position: relative;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        /* Loading Screen */
        #loading-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle at center, #0A0E27 0%, #000000 100%);
            z-index: 10000;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            transition: opacity 0.5s ease;
            contain: strict;
        }

        .loading-content {
            text-align: center;
            max-width: 500px;
            padding: 20px;
        }

        .loading-percentage {
            font-size: 4rem;
            font-weight: bold;
            color: white;
            margin-bottom: 20px;
            transition: color 0.3s ease;
            text-shadow: 0 0 20px currentColor;
        }

        .progress-container {
            width: 100%;
            height: 40px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            overflow: hidden;
            position: relative;
            box-shadow: inset 0 2px 10px rgba(0, 0, 0, 0.3);
        }

        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, var(--error-color), var(--warning-color), var(--success-color));
            border-radius: 20px;
            width: 0%;
            transition: width 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
            box-shadow: 0 0 20px currentColor;
        }

        .progress-bar::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4), transparent);
            animation: shimmer 1.5s infinite;
        }

        .progress-bar.pulse {
            animation: pulse 1s ease-in-out;
        }

        @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        @keyframes pulse {
            0%, 100% { transform: scaleY(1); }
            50% { transform: scaleY(1.1); }
        }

        .loading-text {
            color: white;
            font-size: 1.2rem;
            margin-top: 20px;
            opacity: 0.9;
            min-height: 2em;
            transition: opacity 0.3s ease;
        }

        .celebration-particles {
            position: absolute;
            width: 100%;
            height: 100%;
            pointer-events: none;
            overflow: hidden;
        }

        /* Canvas for particle system */
        #particleCanvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 5;
            opacity: 1;
            transition: opacity 0.3s ease;
        }

        /* Main container */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            position: relative;
            z-index: 10;
            opacity: 0;
            transition: opacity 1s ease;
        }

        .container.loaded {
            opacity: 1;
        }

        /* Hero Section */
        .hero {
            text-align: center;
            padding: 60px 0;
            position: relative;
            contain: layout;
        }

        h1 {
            font-size: clamp(2.5rem, 5vw, 4rem);
            color: white;
            margin-bottom: 20px;
            text-shadow: 0 0 30px rgba(0, 212, 255, 0.5);
            animation: glow 2s ease-in-out infinite alternate;
        }

        @keyframes glow {
            from { text-shadow: 0 0 30px rgba(0, 212, 255, 0.5); }
            to { text-shadow: 0 0 40px rgba(0, 212, 255, 0.8), 0 0 50px rgba(255, 107, 53, 0.5); }
        }

        .tagline {
            color: white;
            font-size: 1.2rem;
            margin-bottom: 30px;
            opacity: 0.9;
        }

        /* McLaren Container */
        .mclaren-container {
            position: relative;
            width: 100%;
            max-width: 800px;
            margin: 40px auto;
            contain: layout paint;
            min-height: 400px;
        }

        .mclaren-svg {
            width: 100%;
            height: auto;
            filter: drop-shadow(0 20px 40px rgba(0, 212, 255, 0.3));
            transition: transform 0.3s ease;
        }

        /* Error container */
        .error-container {
            display: none;
            padding: 20px;
            background: rgba(231, 76, 60, 0.1);
            border: 1px solid var(--error-color);
            border-radius: 10px;
            color: white;
            margin: 20px 0;
            text-align: center;
        }

        .error-container.show {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Services Section */
        .services {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 20px;
            padding: 40px;
            margin: 40px 0;
            backdrop-filter: blur(10px);
            contain: layout paint;
            position: relative;
        }

        .services-header {
            text-align: center;
            margin-bottom: 40px;
        }

        .services h2 {
            color: white;
            font-size: 2.5rem;
            margin-bottom: 20px;
        }

        .service-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
            margin-top: 30px;
        }

        .service-card {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 30px;
            text-align: center;
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
            overflow: hidden;
            transform: translateZ(0);
            contain: paint;
            min-height: 250px;
        }

        .service-card::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, var(--accent-color) 0%, transparent 70%);
            opacity: 0;
            transition: opacity 0.3s ease;
            pointer-events: none;
        }

        .service-card:hover {
            transform: translateY(-5px) translateZ(0);
            box-shadow: 0 10px 30px rgba(0, 212, 255, 0.3);
        }

        .service-card:hover::before {
            opacity: 0.1;
        }

        .service-icon {
            font-size: 3rem;
            margin-bottom: 20px;
            display: block;
        }

        .service-title {
            color: var(--accent-color);
            font-size: 1.5rem;
            margin-bottom: 15px;
        }

        .service-description {
            color: rgba(255, 255, 255, 0.8);
            line-height: 1.6;
            margin-bottom: 20px;
        }

        .service-price {
            color: var(--primary-color);
            font-size: 2rem;
            font-weight: bold;
        }

        /* Contact Section */
        .contact {
            text-align: center;
            padding: 60px 0;
            color: white;
            contain: layout;
        }

        .contact h2 {
            font-size: 2.5rem;
            margin-bottom: 20px;
        }

        .contact-subtitle {
            font-size: 1.2rem;
            margin-bottom: 30px;
            opacity: 0.8;
        }

        .cta-button {
            display: inline-block;
            padding: 20px 50px;
            font-size: 1.2rem;
            background: linear-gradient(45deg, var(--primary-color), var(--accent-color));
            color: white;
            text-decoration: none;
            border-radius: 50px;
            transition: all 0.3s ease;
            box-shadow: 0 5px 20px rgba(255, 107, 53, 0.3);
            position: relative;
            overflow: hidden;
            min-width: 200px;
            min-height: 44px;
            line-height: 44px;
            padding: 0 50px;
            cursor: pointer;
            border: none;
            font-weight: bold;
            letter-spacing: 1px;
            text-transform: uppercase;
        }

        .cta-button::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            background: rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }

        .cta-button:hover::before {
            width: 300px;
            height: 300px;
        }

        .cta-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(255, 107, 53, 0.5);
        }

        /* Offline indicator */
        .offline-indicator {
            position: fixed;
            bottom: 20px;
            left: 20px;
            background: var(--warning-color);
            color: white;
            padding: 10px 20px;
            border-radius: 5px;
            display: none;
            z-index: 1000;
            animation: slideIn 0.3s ease;
        }

        .offline-indicator.show {
            display: block;
        }

        @keyframes slideIn {
            from { transform: translateX(-100%); }
            to { transform: translateX(0); }
        }

        /* Accessibility */
        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border: 0;
        }

        /* Focus states */
        *:focus {
            outline: 3px solid var(--accent-color);
            outline-offset: 2px;
        }

        /* Skip to content link */
        .skip-link {
            position: absolute;
            top: -40px;
            left: 0;
            background: var(--accent-color);
            color: white;
            padding: 8px;
            text-decoration: none;
            z-index: 100;
        }

        .skip-link:focus {
            top: 0;
        }

        /* Mobile optimizations */
        @media (max-width: 768px) {
            .service-grid {
                grid-template-columns: 1fr;
            }
            
            .hero {
                padding: 40px 20px;
            }
            
            h1 {
                font-size: 2rem;
            }
            
            .cta-button {
                padding: 0 40px;
                font-size: 1rem;
            }
            
            .services {
                padding: 30px 20px;
            }
            
            .loading-percentage {
                font-size: 3rem;
            }
        }

        /* Landscape optimizations */
        @media (orientation: landscape) and (max-height: 600px) {
            .hero {
                padding: 20px 0;
            }
            
            .mclaren-container {
                max-width: 600px;
                margin: 20px auto;
            }
            
            h1 {
                font-size: 2rem;
            }
        }

        /* Reduced motion */
        @media (prefers-reduced-motion: reduce) {
            *, *::before, *::after {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
                scroll-behavior: auto !important;
            }
        }

        /* Print styles */
        @media print {
            body {
                background: white;
                color: black;
            }
            
            .hero, .services, .contact {
                page-break-inside: avoid;
            }
            
            #particleCanvas,
            #loading-screen,
            .offline-indicator {
                display: none !important;
            }
            
            .service-card {
                border: 1px solid #ccc;
                box-shadow: none;
            }
            
            a {
                text-decoration: underline;
            }
        }

        /* High contrast mode */
        @media (prefers-contrast: high) {
            :root {
                --primary-color: #FF0000;
                --accent-color: #0080FF;
                --bg-color: #000000;
                --text-color: #FFFFFF;
            }
            
            .service-card {
                border: 2px solid white;
            }
        }

        /* Custom scrollbar */
        ::-webkit-scrollbar {
            width: 10px;
        }

        ::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.1);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--accent-color);
            border-radius: 5px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--primary-color);
        }

        /* Foam cursor */
        .foam-cursor {
            cursor: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32"><circle cx="16" cy="16" r="8" fill="%23FF6B35"/><rect x="14" y="20" width="4" height="8" fill="%23333"/></svg>') 16 16, auto;
        }

        /* SVG Animations */
        @keyframes spinWheel {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        .wheel.spinning {
            animation: spinWheel 1s ease-out;
            transform-origin: center;
        }

        @keyframes doorOpen {
            0% { transform: perspective(1000px) rotateY(0deg); }
            100% { transform: perspective(1000px) rotateY(-25deg); }
        }

        .door-opening {
            animation: doorOpen 1s ease-out forwards;
            transform-origin: left center;
        }

        @keyframes engineRev {
            0%, 100% { transform: scale(1); }
            25% { transform: scale(1.05); }
            50% { transform: scale(0.95); }
            75% { transform: scale(1.03); }
        }

        .engine-revving {
            animation: engineRev 0.5s ease-out;
        }

        @keyframes wiperMove {
            0% { transform: rotate(0deg); }
            50% { transform: rotate(30deg); }
            100% { transform: rotate(0deg); }
        }

        .wiper-active {
            animation: wiperMove 1s ease-in-out;
            transform-origin: bottom center;
        }

        /* Celebration particle */
        .celebration-particle {
            position: absolute;
            width: 10px;
            height: 10px;
            background: var(--primary-color);
            border-radius: 50%;
            pointer-events: none;
            animation: celebrationFall 1s ease-out forwards;
        }

        @keyframes celebrationFall {
            0% {
                transform: translateY(0) scale(0);
                opacity: 1;
            }
            50% {
                transform: translateY(-50px) scale(1);
            }
            100% {
                transform: translateY(100px) scale(0.5);
                opacity: 0;
            }
        }
    </style>

    <!-- All Schema.org structured data -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@graph": [
            {
                "@type": "LocalBusiness",
                "@id": "https://jaysmobilewash.net/#business",
                "name": "Jay's Mobile Wash",
                "description": "Premium mobile car detailing service specializing in luxury vehicles including McLaren",
                "image": [
                    "https://jaysmobilewash.net/logo-1x1.jpg",
                    "https://jaysmobilewash.net/logo-4x3.jpg",
                    "https://jaysmobilewash.net/logo-16x9.jpg"
                ],
                "logo": {
                    "@type": "ImageObject",
                    "url": "https://jaysmobilewash.net/logo.png",
                    "width": 600,
                    "height": 60
                },
                "url": "https://jaysmobilewash.net",
                "telephone": "+1-555-JAY-WASH",
                "priceRange": "$$",
                "address": {
                    "@type": "PostalAddress",
                    "streetAddress": "Mobile Service",
                    "addressLocality": "Los Angeles",
                    "addressRegion": "CA",
                    "postalCode": "90001",
                    "addressCountry": "US"
                },
                "geo": {
                    "@type": "GeoCoordinates",
                    "latitude": 34.0522,
                    "longitude": -118.2437
                },
                "openingHoursSpecification": [
                    {
                        "@type": "OpeningHoursSpecification",
                        "dayOfWeek": ["Monday", "Tuesday", "Wednesday", "Thursday", "Friday"],
                        "opens": "07:00",
                        "closes": "19:00"
                    },
                    {
                        "@type": "OpeningHoursSpecification",
                        "dayOfWeek": ["Saturday", "Sunday"],
                        "opens": "08:00",
                        "closes": "18:00"
                    }
                ],
                "sameAs": [
                    "https://facebook.com/jaysmobilewash",
                    "https://instagram.com/jaysmobilewash",
                    "https://twitter.com/jaysmobilewash"
                ],
                "aggregateRating": {
                    "@type": "AggregateRating",
                    "ratingValue": "4.9",
                    "reviewCount": "127",
                    "bestRating": "5",
                    "worstRating": "1"
                }
            },
            {
                "@type": "Service",
                "@id": "https://jaysmobilewash.net/#service",
                "serviceType": "Mobile Car Detailing",
                "provider": {
                    "@id": "https://jaysmobilewash.net/#business"
                },
                "areaServed": {
                    "@type": "City",
                    "name": "Los Angeles"
                },
                "hasOfferCatalog": {
                    "@type": "OfferCatalog",
                    "name": "Car Detailing Services",
                    "itemListElement": [
                        {
                            "@type": "Offer",
                            "name": "Basic Wash",
                            "price": "49.00",
                            "priceCurrency": "USD",
                            "itemOffered": {
                                "@type": "Service",
                                "name": "Basic Exterior Wash",
                                "description": "Quick exterior wash with foam cannon, tire shine, and window cleaning"
                            }
                        },
                        {
                            "@type": "Offer",
                            "name": "Premium Detail",
                            "price": "149.00",
                            "priceCurrency": "USD",
                            "itemOffered": {
                                "@type": "Service",
                                "name": "Full Interior and Exterior Detail",
                                "description": "Complete interior and exterior detail with paint protection"
                            }
                        },
                        {
                            "@type": "Offer",
                            "name": "McLaren Special",
                            "price": "299.00",
                            "priceCurrency": "USD",
                            "itemOffered": {
                                "@type": "Service",
                                "name": "Luxury Vehicle Treatment",
                                "description": "Premium treatment for high-end vehicles with ceramic coating"
                            }
                        }
                    ]
                }
            },
            {
                "@type": "FAQPage",
                "mainEntity": [
                    {
                        "@type": "Question",
                        "name": "How long does a mobile car wash take?",
                        "acceptedAnswer": {
                            "@type": "Answer",
                            "text": "A basic wash typically takes 30-45 minutes, while a full detail can take 2-3 hours depending on the vehicle size and condition."
                        }
                    },
                    {
                        "@type": "Question",
                        "name": "Do you bring your own water and power?",
                        "acceptedAnswer": {
                            "@type": "Answer",
                            "text": "Yes, we are fully self-contained with our own water supply, power generator, and all necessary cleaning equipment."
                        }
                    },
                    {
                        "@type": "Question",
                        "name": "What areas do you service?",
                        "acceptedAnswer": {
                            "@type": "Answer",
                            "text": "We service all of Los Angeles County including downtown LA, Beverly Hills, Santa Monica, and surrounding areas."
                        }
                    },
                    {
                        "@type": "Question",
                        "name": "Can you detail luxury cars like McLaren?",
                        "acceptedAnswer": {
                            "@type": "Answer",
                            "text": "Absolutely! We specialize in high-end luxury vehicles and are certified to work on McLaren, Ferrari, Lamborghini, and other exotic cars."
                        }
                    }
                ]
            },
            {
                "@type": "WebSite",
                "@id": "https://jaysmobilewash.net/#website",
                "url": "https://jaysmobilewash.net",
                "name": "Jay's Mobile Wash",
                "description": "Professional mobile car detailing service",
                "publisher": {
                    "@id": "https://jaysmobilewash.net/#business"
                },
                "potentialAction": {
                    "@type": "SearchAction",
                    "target": "https://jaysmobilewash.net/search?q={search_term_string}",
                    "query-input": "required name=search_term_string"
                }
            },
            {
                "@type": "BreadcrumbList",
                "itemListElement": [
                    {
                        "@type": "ListItem",
                        "position": 1,
                        "name": "Home",
                        "item": "https://jaysmobilewash.net"
                    },
                    {
                        "@type": "ListItem",
                        "position": 2,
                        "name": "Services",
                        "item": "https://jaysmobilewash.net/#services"
                    },
                    {
                        "@type": "ListItem",
                        "position": 3,
                        "name": "Contact",
                        "item": "https://jaysmobilewash.net/#contact"
                    }
                ]
            }
        ]
    }
    </script>
</head>
<body class="foam-cursor">
    <!-- Skip to content for accessibility -->
    <a href="#main" class="skip-link">Skip to main content</a>

    <!-- Loading Screen -->
    <div id="loading-screen" role="status" aria-live="polite">
        <div class="loading-content">
            <div class="loading-percentage" aria-label="Loading progress">0%</div>
            <div class="progress-container">
                <div class="progress-bar" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div>
            </div>
            <div class="loading-text">Initializing...</div>
            <div class="celebration-particles"></div>
        </div>
    </div>

    <!-- Particle Canvas -->
    <canvas id="particleCanvas" class="gpu" aria-hidden="true"></canvas>

    <!-- Offline Indicator -->
    <div class="offline-indicator" role="alert" aria-live="assertive">
        <span>📡 You're offline - Some features may be limited</span>
    </div>

    <!-- Main Content -->
    <main id="main" class="container">
        <section class="hero" itemscope itemtype="https://schema.org/LocalBusiness">
            <h1 itemprop="name">Jay's Mobile Wash</h1>
            <p class="tagline" itemprop="description">McLaren-Level Detailing at Your Location</p>
            
            <!-- McLaren Container -->
            <div class="mclaren-container">
                <div class="error-container" id="mclarenError" role="alert">
                    <p>McLaren visualization couldn't load, but don't worry - our service is still amazing!</p>
                </div>
                
                <!-- SVG McLaren with interactive zones -->
                <svg class="mclaren-svg gpu" viewBox="0 0 800 400" xmlns="http://www.w3.org/2000/svg" aria-label="Interactive McLaren P1">
                    <defs>
                        <!-- Reusable symbols -->
                        <symbol id="wheel" viewBox="0 0 100 100">
                            <circle cx="50" cy="50" r="45" fill="#222" stroke="#444" stroke-width="2"/>
                            <circle cx="50" cy="50" r="35" fill="#333"/>
                            <path d="M50 15 L50 85 M15 50 L85 50" stroke="#555" stroke-width="3"/>
                            <circle cx="50" cy="50" r="25" fill="#444"/>
                            <circle cx="50" cy="50" r="15" fill="#555"/>
                            <circle cx="50" cy="50" r="8" fill="#FF6B35"/>
                        </symbol>
                        
                        <!-- Gradients -->
                        <linearGradient id="bodyGradient" x1="0%" y1="0%" x2="100%" y2="0%">
                            <stop offset="0%" style="stop-color:#FF6B35;stop-opacity:1" />
                            <stop offset="50%" style="stop-color:#FF8C42;stop-opacity:1" />
                            <stop offset="100%" style="stop-color:#FF6B35;stop-opacity:1" />
                        </linearGradient>
                        
                        <radialGradient id="lightGradient">
                            <stop offset="0%" style="stop-color:#FFF;stop-opacity:0.8" />
                            <stop offset="100%" style="stop-color:#FFF;stop-opacity:0" />
                        </radialGradient>
                        
                        <filter id="carShadow">
                            <feGaussianBlur in="SourceAlpha" stdDeviation="10"/>
                            <feOffset dx="0" dy="20" result="offsetblur"/>
                            <feFlood flood-color="#000000" flood-opacity="0.3"/>
                            <feComposite in2="offsetblur" operator="in"/>
                            <feMerge>
                                <feMergeNode/>
                                <feMergeNode in="SourceGraphic"/>
                            </feMerge>
                        </filter>
                    </defs>
                    
                    <!-- Car Body Group -->
                    <g id="mclarenBody" filter="url(#carShadow)">
                        <!-- Main chassis -->
                        <path d="M100 250 Q120 220 200 200 L300 195 Q400 190 500 195 L600 200 Q680 220 700 250 L695 280 Q690 300 680 305 L650 310 Q600 315 550 315 L250 315 Q200 315 150 310 L120 305 Q110 300 105 280 Z" 
                              fill="url(#bodyGradient)" 
                              stroke="#222" 
                              stroke-width="2"
                              class="car-body"/>
                        
                        <!-- Hood -->
                        <path d="M200 200 Q250 195 300 195 L350 195 Q380 193 400 195 L400 220 L380 225 Q350 227 320 225 L220 220 Q200 215 200 200" 
                              fill="#FF7C3D" 
                              stroke="#222" 
                              stroke-width="1"/>
                        
                        <!-- Roof -->
                        <path d="M300 195 Q320 160 400 160 Q480 160 500 195 L480 200 Q450 180 400 180 Q350 180 320 200 Z" 
                              fill="#222" 
                              stroke="#111" 
                              stroke-width="2"/>
                        
                        <!-- Front windshield -->
                        <path d="M320 195 Q340 170 380 168 L420 168 Q460 170 480 195 L470 200 L330 200 Z" 
                              fill="#1a1a1a" 
                              opacity="0.8"
                              stroke="#333"
                              stroke-width="1"
                              class="windshield"/>
                        
                        <!-- Side windows -->
                        <path d="M330 200 L470 200 L465 220 L460 225 L340 225 L335 220 Z" 
                              fill="#1a1a1a" 
                              opacity="0.7"
                              stroke="#333"
                              stroke-width="1"/>
                        
                        <!-- Side vents -->
                        <g id="engineVents">
                            <rect x="520" y="220" width="80" height="35" rx="5" fill="#111" stroke="#222"/>
                            <rect x="530" y="228" width="60" height="4" rx="2" fill="#FF6B35"/>
                            <rect x="530" y="236" width="60" height="4" rx="2" fill="#FF6B35"/>
                            <rect x="530" y="244" width="60" height="4" rx="2" fill="#FF6B35"/>
                        </g>
                        
                        <!-- Door lines -->
                        <path d="M350 200 L350 295 M450 200 L450 295" 
                              fill="none" 
                              stroke="#111" 
                              stroke-width="1"
                              class="door-outline"/>
                        
                        <!-- Door handle -->
                        <rect x="360" y="240" width="30" height="8" rx="4" fill="#222" stroke="#111"/>
                        
                        <!-- Side mirrors -->
                        <ellipse cx="310" cy="205" rx="15" ry="8" fill="#222" stroke="#111"/>
                        <ellipse cx="490" cy="205" rx="15" ry="8" fill="#222" stroke="#111"/>
                        
                        <!-- Spoiler -->
                        <path d="M600 200 Q620 190 640 195 L635 205 Q620 210 605 205 Z" 
                              fill="#222" 
                              stroke="#111" 
                              stroke-width="1"/>
                    </g>
                    
                    <!-- Wheels -->
                    <g id="wheels">
                        <use href="#wheel" x="150" y="270" width="80" height="80" class="wheel front-wheel"/>
                        <use href="#wheel" x="520" y="270" width="80" height="80" class="wheel rear-wheel"/>
                    </g>
                    
                    <!-- Headlights -->
                    <g id="headlights">
                        <ellipse cx="120" cy="240" rx="25" ry="15" fill="#FFF" opacity="0.2"/>
                        <ellipse cx="120" cy="240" rx="20" ry="12" fill="url(#lightGradient)" class="headlight-glow"/>
                        <circle cx="115" cy="238" r="8" fill="#FFF" opacity="0.8"/>
                        <circle cx="125" cy="238" r="8" fill="#FFF" opacity="0.8"/>
                    </g>
                    
                    <!-- Tail lights -->
                    <g id="taillights">
                        <rect x="690" y="235" width="8" height="20" rx="4" fill="#E74C3C" opacity="0.8"/>
                        <rect x="690" y="260" width="8" height="20" rx="4" fill="#E74C3C" opacity="0.8"/>
                    </g>
                    
                    <!-- Interactive hover zones -->
                    <g id="hoverZones">
                        <rect x="150" y="270" width="80" height="80" fill="transparent" class="hover-zone wheel-zone front" data-action="spin-wheel" cursor="pointer">
                            <title>Click to spin front wheel</title>
                        </rect>
                        <rect x="520" y="270" width="80" height="80" fill="transparent" class="hover-zone wheel-zone rear" data-action="spin-wheel" cursor="pointer">
                            <title>Click to spin rear wheel</title>
                        </rect>
                        <rect x="350" y="200" width="100" height="95" fill="transparent" class="hover-zone door-zone" data-action="open-door" cursor="pointer">
                            <title>Click to open door</title>
                        </rect>
                        <rect x="520" y="220" width="80" height="35" fill="transparent" class="hover-zone engine-zone" data-action="rev-engine" cursor="pointer">
                            <title>Click to rev engine</title>
                        </rect>
                        <path d="M320 195 Q340 170 380 168 L420 168 Q460 170 480 195 L470 200 L330 200 Z" fill="transparent" class="hover-zone windshield-zone" data-action="wiper" cursor="pointer">
                            <title>Click to activate wipers</title>
                        </path>
                    </g>
                </svg>
            </div>
        </section>

        <section class="services contain-paint" id="services" aria-labelledby="services-heading">
            <div class="error-container" id="servicesError" role="alert">
                <p>Services section had a loading issue, but we're still here to help!</p>
            </div>
            
            <div class="services-header">
                <h2 id="services-heading">Our Premium Services</h2>
                <p class="tagline">Professional detailing that exceeds expectations</p>
            </div>
            
            <div class="service-grid">
                <article class="service-card gpu" itemscope itemtype="https://schema.org/Offer">
                    <span class="service-icon" aria-hidden="true">🚗</span>
                    <h3 class="service-title" itemprop="name">Basic Wash</h3>
                    <p class="service-description" itemprop="description">Quick exterior wash with foam cannon, tire shine, and window cleaning. Perfect for regular maintenance.</p>
                    <p class="service-price">
                        <span itemprop="priceCurrency" content="USD">$</span>
                        <span itemprop="price" content="49.00">49</span>
                    </p>
                </article>
                
                <article class="service-card gpu" itemscope itemtype="https://schema.org/Offer">
                    <span class="service-icon" aria-hidden="true">✨</span>
                    <h3 class="service-title" itemprop="name">Premium Detail</h3>
                    <p class="service-description" itemprop="description">Full interior and exterior detail with paint protection. Includes vacuum, shampoo, and polish.</p>
                    <p class="service-price">
                        <span itemprop="priceCurrency" content="USD">$</span>
                        <span itemprop="price" content="149.00">149</span>
                    </p>
                </article>
                
                <article class="service-card gpu" itemscope itemtype="https://schema.org/Offer">
                    <span class="service-icon" aria-hidden="true">🏎️</span>
                    <h3 class="service-title" itemprop="name">McLaren Special</h3>
                    <p class="service-description" itemprop="description">Luxury treatment for high-end vehicles with ceramic coating. White glove service for your prized possession.</p>
                    <p class="service-price">
                        <span itemprop="priceCurrency" content="USD">$</span>
                        <span itemprop="price" content="299.00">299</span>
                    </p>
                </article>
            </div>
        </section>

        <section class="contact contain-layout" id="contact" aria-labelledby="contact-heading">
            <h2 id="contact-heading">Ready for the Best Wash of Your Life?</h2>
            <p class="contact-subtitle">We come to you - Home, Office, Anywhere!</p>
            <a href="tel:+1555JAYWASH" class="cta-button gpu" itemprop="telephone">
                <span class="sr-only">Call us at </span>Book Now
            </a>
            <div class="error-container" id="contactError" role="alert">
                <p>Contact form couldn't load, but you can still call us at 555-JAY-WASH!</p>
            </div>
        </section>
    </main>

    <script>
        (function() {
            'use strict';

            // Performance timing
            const performanceData = {
                start: performance.now(),
                marks: {}
            };

            // Mark performance points
            function perfMark(name) {
                performanceData.marks[name] = performance.now() - performanceData.start;
            }

            // Resource management with WeakMap for garbage collection
            const resourceCache = new WeakMap();
            const activeTimers = new Set();
            const activeAnimations = new Set();

            // Error handling system with fallback
            const ErrorHandler = {
                errors: [],
                maxErrors: 50,
                retryAttempts: new Map(),
                
                log: function(error, context, severity = 'error') {
                    this.errors.push({
                        error: error,
                        context: context,
                        severity: severity,
                        timestamp: Date.now()
                    });
                    
                    if (this.errors.length > this.maxErrors) {
                        this.errors.shift();
                    }
                    
                    if (console && console[severity]) {
                        console[severity](`[${context}]`, error);
                    }
                    
                    // Show error in UI if critical
                    if (severity === 'critical') {
                        this.showError(context);
                    }
                },
                
                showError: function(context) {
                    const errorContainers = {
                        'McLaren': 'mclarenError',
                        'Services': 'servicesError',
                        'Contact': 'contactError'
                    };
                    
                    const containerId = errorContainers[context];
                    if (containerId) {
                        const container = document.getElementById(containerId);
                        if (container) {
                            container.classList.add('show');
                        }
                    }
                },
                
                retry: function(fn, context, maxRetries = 3) {
                    const attempts = this.retryAttempts.get(fn) || 0;
                    
                    if (attempts < maxRetries) {
                        this.retryAttempts.set(fn, attempts + 1);
                        const delay = Math.pow(2, attempts) * 1000; // Exponential backoff
                        
                        setTimeout(() => {
                            try {
                                fn();
                            } catch (error) {
                                this.log(error, context);
                                this.retry(fn, context, maxRetries);
                            }
                        }, delay);
                    } else {
                        this.log(new Error('Max retries exceeded'), context, 'critical');
                    }
                },
                
                wrap: function(fn, context) {
                    return function(...args) {
                        try {
                            return fn.apply(this, args);
                        } catch (error) {
                            ErrorHandler.log(error, context);
                            return null;
                        }
                    };
                }
            };

            // Intersection Observer for lazy loading and performance
            const observerManager = {
                observers: new Map(),
                
                create: function(callback, options = {}) {
                    if (!('IntersectionObserver' in window)) {
                        // Fallback for older browsers
                        return { observer: null, id: null };
                    }
                    
                    const observer = new IntersectionObserver(callback, {
                        root: null,
                        rootMargin: '50px',
                        threshold: 0.01,
                        ...options
                    });
                    
                    const id = Date.now() + Math.random();
                    this.observers.set(id, observer);
                    return { observer, id };
                },
                
                destroy: function(id) {
                    const observer = this.observers.get(id);
                    if (observer) {
                        observer.disconnect();
                        this.observers.delete(id);
                    }
                },
                
                destroyAll: function() {
                    this.observers.forEach(observer => observer.disconnect());
                    this.observers.clear();
                }
            };

            // Loading Module with progress tracking
            const LoadingModule = {
                elements: {},
                startTime: Date.now(),
                duration: 7000,
                isComplete: false,
                progressSteps: [
                    { percent: 25, celebration: true },
                    { percent: 50, celebration: true, pulse: true },
                    { percent: 75, celebration: true }
                ],
                
                init: function() {
                    this.elements = {
                        screen: document.getElementById('loading-screen'),
                        bar: document.querySelector('.progress-bar'),
                        text: document.querySelector('.loading-text'),
                        percent: document.querySelector('.loading-percentage'),
                        container: document.querySelector('.container'),
                        celebrationContainer: document.querySelector('.celebration-particles')
                    };
                    
                    if (!this.validateElements()) {
                        this.skipLoading();
                        return;
                    }
                    
                    this.startProgress();
                    perfMark('loadingStarted');
                },
                
                validateElements: function() {
                    const requiredElements = ['screen', 'bar', 'text', 'percent', 'container'];
                    return requiredElements.every(key => this.elements[key] !== null);
                },
                
                skipLoading: function() {
                    ErrorHandler.log('Loading elements not found, skipping loading screen', 'LoadingModule', 'warn');
                    if (this.elements.screen) {
                        this.elements.screen.style.display = 'none';
                    }
                    if (this.elements.container) {
                        this.elements.container.classList.add('loaded');
                    }
                    this.initializeApp();
                },
                
                startProgress: function() {
                    // Jump to 15% immediately
                    this.updateProgress(15);
                    
                    const messages = [
                        { time: 0, text: "Initializing foam cannons..." },
                        { time: 1500, text: "Loading something special..." },
                        { time: 3000, text: "Preparing McLaren visualization..." },
                        { time: 4500, text: "Almost there, this is worth it!" },
                        { time: 6000, text: "HERE IT COMES!" },
                        { time: 6800, text: "LET'S FUCKING GO!" }
                    ];
                    
                    let lastMessageIndex = -1;
                    let lastCelebration = 0;
                    
                    const progressTimer = setInterval(() => {
                        const elapsed = Date.now() - this.startTime;
                        const progress = Math.min(elapsed / this.duration, 1);
                        
                        // Calculate display progress with specific curve
                        let displayProgress;
                        if (progress < 0.786) { // Up to 5.5 seconds (85%)
                            displayProgress = 15 + (70 * (progress / 0.786));
                        } else if (progress < 0.971) { // 5.5 to 6.8 seconds (99%)
                            const slowProgress = (progress - 0.786) / (0.971 - 0.786);
                            displayProgress = 85 + (14 * slowProgress);
                        } else {
                            displayProgress = 100;
                        }
                        
                        this.updateProgress(displayProgress);
                        
                        // Update message based on time
                        const currentTime = Date.now() - this.startTime;
                        for (let i = messages.length - 1; i >= 0; i--) {
                            if (currentTime >= messages[i].time && i > lastMessageIndex) {
                                this.updateMessage(messages[i].text);
                                lastMessageIndex = i;
                                break;
                            }
                        }
                        
                        // Check for celebration milestones
                        this.checkMilestones(displayProgress, lastCelebration);
                        if (displayProgress >= 25 && lastCelebration < 25) lastCelebration = 25;
                        if (displayProgress >= 50 && lastCelebration < 50) lastCelebration = 50;
                        if (displayProgress >= 75 && lastCelebration < 75) lastCelebration = 75;
                        
                        if (displayProgress >= 100) {
                            clearInterval(progressTimer);
                            activeTimers.delete(progressTimer);
                            setTimeout(() => this.complete(), 200);
                        }
                    }, 50);
                    
                    activeTimers.add(progressTimer);
                },
                
                updateProgress: function(percent) {
                    if (this.elements.bar) {
                        this.elements.bar.style.width = percent + '%';
                        this.elements.bar.setAttribute('aria-valuenow', Math.floor(percent));
                        
                        // Update color based on progress (red -> yellow -> green)
                        const red = percent < 50 ? 255 : Math.floor(255 - (percent - 50) * 5.1);
                        const green = percent < 50 ? Math.floor(percent * 5.1) : 255;
                        const blue = 0;
                        this.elements.bar.style.background = `linear-gradient(90deg, rgb(${red}, ${green}, ${blue}), rgb(${red}, ${green}, ${blue + 50}))`;
                    }
                    
                    if (this.elements.percent) {
                        this.elements.percent.textContent = Math.floor(percent) + '%';
                        this.elements.percent.style.color = `rgb(${255 - percent * 2.55}, ${percent * 2.55}, ${percent * 1.5})`;
                    }
                },
                
                updateMessage: function(text) {
                    if (this.elements.text) {
                        this.elements.text.style.opacity = '0';
                        setTimeout(() => {
                            this.elements.text.textContent = text;
                            this.elements.text.style.opacity = '1';
                        }, 150);
                    }
                },
                
                checkMilestones: function(percent, lastCelebration) {
                    this.progressSteps.forEach(step => {
                        if (percent >= step.percent && lastCelebration < step.percent) {
                            if (step.celebration) {
                                this.triggerCelebration(step.percent);
                            }
                            if (step.pulse && this.elements.bar) {
                                this.elements.bar.classList.add('pulse');
                                setTimeout(() => {
                                    this.elements.bar.classList.remove('pulse');
                                }, 1000);
                            }
                        }
                    });
                },
                
                triggerCelebration: function(percent) {
                    if (!this.elements.celebrationContainer) return;
                    
                    const colors = ['#FF6B35', '#3498DB', '#2ECC71', '#F1C40F'];
                    const particleCount = 20;
                    
                    for (let i = 0; i < particleCount; i++) {
                        const particle = document.createElement('div');
                        particle.className = 'celebration-particle';
                        particle.style.left = (30 + percent * 0.4) + '%';
                        particle.style.background = colors[Math.floor(Math.random() * colors.length)];
                        particle.style.transform = `rotate(${Math.random() * 360}deg)`;
                        
                        this.elements.celebrationContainer.appendChild(particle);
                        
                        setTimeout(() => {
                            particle.remove();
                        }, 1000);
                    }
                },
                
                complete: function() {
                    if (this.elements.screen) {
                        this.elements.screen.style.opacity = '0';
                        setTimeout(() => {
                            this.elements.screen.style.display = 'none';
                            this.initializeApp();
                        }, 500);
                    }
                    
                    if (this.elements.container) {
                        this.elements.container.classList.add('loaded');
                    }
                    
                    perfMark('loadingComplete');
                    this.isComplete = true;
                },
                
                initializeApp: function() {
                    ParticleSystem.init();
                    McLarenInteractions.init();
                    ServiceWorkerManager.init();
                    OfflineManager.init();
                    LazyLoadManager.init();
                    
                    // Clean up loading resources
                    this.cleanup();
                }
            };

            // Canvas-based Particle System with object pooling
            const ParticleSystem = {
                canvas: null,
                ctx: null,
                particles: [],
                particlePool: [],
                maxParticles: 200,
                isActive: true,
                mouseX: 0,
                mouseY: 0,
                isDragging: false,
                audioContext: null,
                analyser: null,
                dataArray: null,
                
                init: function() {
                    this.canvas = document.getElementById('particleCanvas');
                    if (!this.canvas) {
                        ErrorHandler.log('Particle canvas not found', 'ParticleSystem');
                        return;
                    }
                    
                    this.ctx = this.canvas.getContext('2d');
                    if (!this.ctx) {
                        ErrorHandler.log('Canvas context not available', 'ParticleSystem');
                        return;
                    }
                    
                    this.resize();
                    this.createParticlePool();
                    this.bindEvents();
                    this.startAnimation();
                    this.initAudioContext();
                    
                    perfMark('particleSystemInitialized');
                },
                
                resize: function() {
                    this.canvas.width = window.innerWidth;
                    this.canvas.height = window.innerHeight;
                },
                
                createParticlePool: function() {
                    for (let i = 0; i < this.maxParticles; i++) {
                        this.particlePool.push({
                            x: 0,
                            y: 0,
                            vx: 0,
                            vy: 0,
                            size: 0,
                            color: '',
                            life: 0,
                            maxLife: 0,
                            type: 'foam',
                            active: false,
                            targetX: null,
                            targetY: null,
                            magnetStrength: 0
                        });
                    }
                },
                
                getParticle: function() {
                    return this.particlePool.find(p => !p.active) || null;
                },
                
                bindEvents: function() {
                    // Mouse events
                    const handleMove = (e) => {
                        this.mouseX = e.clientX;
                        this.mouseY = e.clientY;
                    };
                    
                    const handleClick = (e) => {
                        this.createFoamBurst(e.clientX, e.clientY);
                    };
                    
                    const handleMouseDown = () => { this.isDragging = true; };
                    const handleMouseUp = () => { this.isDragging = false; };
                    
                    document.addEventListener('mousemove', handleMove, { passive: true });
                    document.addEventListener('click', handleClick, { passive: true });
                    document.addEventListener('mousedown', handleMouseDown, { passive: true });
                    document.addEventListener('mouseup', handleMouseUp, { passive: true });
                    
                    // Touch events
                    document.addEventListener('touchmove', (e) => {
                        if (e.touches.length > 0) {
                            this.mouseX = e.touches[0].clientX;
                            this.mouseY = e.touches[0].clientY;
                        }
                    }, { passive: true });
                    
                    document.addEventListener('touchstart', (e) => {
                        this.isDragging = true;
                        if (e.touches.length > 0) {
                            this.createFoamBurst(e.touches[0].clientX, e.touches[0].clientY);
                        }
                    }, { passive: true });
                    
                    document.addEventListener('touchend', () => {
                        this.isDragging = false;
                    }, { passive: true });
                    
                    // Window resize
                    window.addEventListener('resize', ErrorHandler.wrap(() => {
                        this.resize();
                    }, 'ParticleResize'));
                    
                    // Visibility change
                    document.addEventListener('visibilitychange', () => {
                        this.isActive = !document.hidden;
                    });
                },
                
                initAudioContext: function() {
                    if (window.AudioContext || window.webkitAudioContext) {
                        try {
                            this.audioContext = new (window.AudioContext || window.webkitAudioContext)();
                            this.analyser = this.audioContext.createAnalyser();
                            this.analyser.fftSize = 256;
                            this.dataArray = new Uint8Array(this.analyser.frequencyBinCount);
                        } catch (error) {
                            ErrorHandler.log(error, 'AudioContext', 'warn');
                        }
                    }
                },
                
                createFoamBurst: function(x, y) {
                    const burstCount = 30;
                    
                    for (let i = 0; i < burstCount; i++) {
                        const particle = this.getParticle();
                        if (!particle) break;
                        
                        const angle = (Math.PI * 2 * i) / burstCount;
                        const velocity = 5 + Math.random() * 10;
                        
                        particle.x = x;
                        particle.y = y;
                        particle.vx = Math.cos(angle) * velocity;
                        particle.vy = Math.sin(angle) * velocity;
                        particle.size = 5 + Math.random() * 10;
                        particle.color = '#FFFFFF';
                        particle.life = 1;
                        particle.maxLife = 3000;
                        particle.type = 'foam';
                        particle.active = true;
                        particle.magnetStrength = 0.2 + Math.random() * 0.3;
                        
                        // Set McLaren as magnetic target
                        const mclarenBounds = document.querySelector('.mclaren-svg')?.getBoundingClientRect();
                        if (mclarenBounds) {
                            particle.targetX = mclarenBounds.left + mclarenBounds.width / 2;
                            particle.targetY = mclarenBounds.top + mclarenBounds.height / 2;
                        }
                    }
                },
                
                updateParticles: function(deltaTime) {
                    const gravity = 0.3;
                    const friction = 0.98;
                    const audioBoost = this.getAudioBoost();
                    
                    this.particles = this.particlePool.filter(p => p.active);
                    
                    this.particles.forEach(particle => {
                        if (!particle.active) return;
                        
                        // Apply gravity
                        particle.vy += gravity;
                        
                        // Apply friction
                        particle.vx *= friction;
                        particle.vy *= friction;
                        
                        // Magnetic attraction to McLaren
                        if (particle.targetX && particle.targetY) {
                            const dx = particle.targetX - particle.x;
                            const dy = particle.targetY - particle.y;
                            const distance = Math.sqrt(dx * dx + dy * dy);
                            
                            if (distance > 50) {
                                particle.vx += (dx / distance) * particle.magnetStrength;
                                particle.vy += (dy / distance) * particle.magnetStrength;
                            }
                        }
                        
                        // Surface tension - attract nearby foam particles
                        this.particles.forEach(other => {
                            if (other === particle || !other.active) return;
                            
                            const dx = other.x - particle.x;
                            const dy = other.y - particle.y;
                            const distance = Math.sqrt(dx * dx + dy * dy);
                            
                            if (distance < 30 && distance > 0) {
                                const force = 0.05 * (30 - distance) / 30;
                                particle.vx += (dx / distance) * force;
                                particle.vy += (dy / distance) * force;
                            }
                        });
                        
                        // Audio reactive movement
                        if (audioBoost > 0) {
                            particle.vx += (Math.random() - 0.5) * audioBoost;
                            particle.vy += (Math.random() - 0.5) * audioBoost;
                        }
                        
                        // Update position
                        particle.x += particle.vx;
                        particle.y += particle.vy;
                        
                        // Update life
                        particle.life -= deltaTime / particle.maxLife;
                        
                        // Deactivate if dead or out of bounds
                        if (particle.life <= 0 || particle.y > this.canvas.height + 50) {
                            particle.active = false;
                        }
                    });
                    
                    // Create continuous stream when dragging
                    if (this.isDragging && Math.random() < 0.8) {
                        const particle = this.getParticle();
                        if (particle) {
                            particle.x = this.mouseX;
                            particle.y = this.mouseY;
                            particle.vx = (Math.random() - 0.5) * 5;
                            particle.vy = Math.random() * 3;
                            particle.size = 10 + Math.random() * 15;
                            particle.color = '#FFFFFF';
                            particle.life = 1;
                            particle.maxLife = 3000;
                            particle.type = 'foam';
                            particle.active = true;
                        }
                    }
                },
                
                getAudioBoost: function() {
                    if (!this.analyser || !this.dataArray) return 0;
                    
                    this.analyser.getByteFrequencyData(this.dataArray);
                    
                    let sum = 0;
                    for (let i = 0; i < this.dataArray.length; i++) {
                        sum += this.dataArray[i];
                    }
                    
                    return (sum / this.dataArray.length) / 10;
                },
                
                render: function() {
                    this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);
                    
                    this.particles.forEach(particle => {
                        if (!particle.active) return;
                        
                        this.ctx.save();
                        this.ctx.globalAlpha = particle.life;
                        
                        // Draw foam particle
                        const gradient = this.ctx.createRadialGradient(
                            particle.x, particle.y, 0,
                            particle.x, particle.y, particle.size
                        );
                        
                        if (particle.type === 'foam') {
                            gradient.addColorStop(0, 'rgba(255, 255, 255, 0.8)');
                            gradient.addColorStop(1, 'rgba(255, 255, 255, 0)');
                        } else if (particle.type === 'water') {
                            gradient.addColorStop(0, 'rgba(0, 212, 255, 0.8)');
                            gradient.addColorStop(1, 'rgba(0, 212, 255, 0)');
                        }
                        
                        this.ctx.fillStyle = gradient;
                        this.ctx.beginPath();
                        this.ctx.arc(particle.x, particle.y, particle.size, 0, Math.PI * 2);
                        this.ctx.fill();
                        
                        // Add glow effect
                        this.ctx.shadowBlur = 10;
                        this.ctx.shadowColor = particle.color;
                        this.ctx.fill();
                        
                        this.ctx.restore();
                    });
                },
                
                startAnimation: function() {
                    let lastTime = performance.now();
                    
                    const animate = (currentTime) => {
                        if (!this.isActive) {
                            requestAnimationFrame(animate);
                            return;
                        }
                        
                        const deltaTime = currentTime - lastTime;
                        lastTime = currentTime;
                        
                        this.updateParticles(deltaTime);
                        this.render();
                        
                        requestAnimationFrame(animate);
                    };
                    
                    requestAnimationFrame(animate);
                },
                
                cleanup: function() {
                    // Reset all particles
                    this.particlePool.forEach(p => p.active = false);
                    this.particles = [];
                }
            };

            // McLaren Interactions Module
            const McLarenInteractions = {
                svg: null,
                wheels: [],
                animationFrames: new Map(),
                
                init: function() {
                    this.svg = document.querySelector('.mclaren-svg');
                    if (!this.svg) {
                        ErrorHandler.log('McLaren SVG not found', 'McLarenInteractions');
                        return;
                    }
                    
                    this.bindInteractions();
                    perfMark('mclarenInteractionsInitialized');
                },
                
                bindInteractions: function() {
                    const hoverZones = this.svg.querySelectorAll('.hover-zone');
                    
                    hoverZones.forEach(zone => {
                        zone.addEventListener('click', ErrorHandler.wrap((e) => {
                            e.preventDefault();
                            const action = e.currentTarget.dataset.action;
                            this.handleAction(action, e.currentTarget);
                        }, 'McLarenClick'));
                        
                        zone.addEventListener('mouseenter', ErrorHandler.wrap((e) => {
                            e.currentTarget.style.fill = 'rgba(255, 107, 53, 0.1)';
                        }, 'McLarenHover'));
                        
                        zone.addEventListener('mouseleave', ErrorHandler.wrap((e) => {
                            e.currentTarget.style.fill = 'transparent';
                        }, 'McLarenLeave'));
                    });
                },
                
                handleAction: function(action, element) {
                    switch(action) {
                        case 'spin-wheel':
                            this.spinWheel(element);
                            break;
                        case 'open-door':
                            this.openDoor();
                            break;
                        case 'rev-engine':
                            this.revEngine();
                            break;
                        case 'wiper':
                            this.activateWiper();
                            break;
                    }
                },
                
                spinWheel: function(element) {
                    const isRear = element.classList.contains('rear');
                    const wheel = this.svg.querySelector(isRear ? '.rear-wheel' : '.front-wheel');
                    
                    if (wheel && !wheel.classList.contains('spinning')) {
                        wheel.classList.add('spinning');
                        
                        // Create tire smoke particles
                        const rect = wheel.getBoundingClientRect();
                        const x = rect.left + rect.width / 2;
                        const y = rect.bottom;
                        
                        for (let i = 0; i < 10; i++) {
                            setTimeout(() => {
                                const particle = ParticleSystem.getParticle();
                                if (particle) {
                                    particle.x = x + (Math.random() - 0.5) * 20;
                                    particle.y = y;
                                    particle.vx = (Math.random() - 0.5) * 3;
                                    particle.vy = -Math.random() * 5;
                                    particle.size = 15 + Math.random() * 10;
                                    particle.color = '#CCCCCC';
                                    particle.life = 1;
                                    particle.maxLife = 1500;
                                    particle.type = 'smoke';
                                    particle.active = true;
                                }
                            }, i * 50);
                        }
                        
                        setTimeout(() => {
                            wheel.classList.remove('spinning');
                        }, 1000);
                    }
                },
                
                openDoor: function() {
                    const doorPath = this.svg.querySelector('.door-outline');
                    const doorGroup = doorPath?.parentElement;
                    
                    if (doorGroup && !doorGroup.classList.contains('door-opening')) {
                        doorGroup.classList.add('door-opening');
                        
                        setTimeout(() => {
                            doorGroup.classList.remove('door-opening');
                        }, 2000);
                    }
                },
                
                revEngine: function() {
                    const carBody = this.svg.querySelector('#mclarenBody');
                    if (carBody && !carBody.classList.contains('engine-revving')) {
                        carBody.classList.add('engine-revving');
                        
                        // Create exhaust particles
                        const exhaustX = 700;
                        const exhaustY = 270;
                        
                        for (let i = 0; i < 20; i++) {
                            setTimeout(() => {
                                const particle = ParticleSystem.getParticle();
                                if (particle) {
                                    particle.x = exhaustX;
                                    particle.y = exhaustY;
                                    particle.vx = 5 + Math.random() * 10;
                                    particle.vy = (Math.random() - 0.5) * 5;
                                    particle.size = 10 + Math.random() * 20;
                                    particle.color = '#666666';
                                    particle.life = 1;
                                    particle.maxLife = 2000;
                                    particle.type = 'exhaust';
                                    particle.active = true;
                                }
                            }, i * 30);
                        }
                        
                        setTimeout(() => {
                            carBody.classList.remove('engine-revving');
                        }, 500);
                    }
                },
                
                activateWiper: function() {
                    const windshield = this.svg.querySelector('.windshield');
                    if (windshield && !windshield.classList.contains('wiper-active')) {
                        windshield.classList.add('wiper-active');
                        
                        // Create water droplet particles
                        const rect = windshield.getBoundingClientRect();
                        
                        for (let i = 0; i < 15; i++) {
                            const particle = ParticleSystem.getParticle();
                            if (particle) {
                                particle.x = rect.left + Math.random() * rect.width;
                                particle.y = rect.top + Math.random() * rect.height;
                                particle.vx = (Math.random() - 0.5) * 10;
                                particle.vy = -Math.random() * 10;
                                particle.size = 3 + Math.random() * 5;
                                particle.color = '#00D4FF';
                                particle.life = 1;
                                particle.maxLife = 1000;
                                particle.type = 'water';
                                particle.active = true;
                            }
                        }
                        
                        setTimeout(() => {
                            windshield.classList.remove('wiper-active');
                        }, 1000);
                    }
                }
            };

            // Service Worker Manager
            const ServiceWorkerManager = {
                registration: null,
                
                init: function() {
                    if ('serviceWorker' in navigator) {
                        this.register();
                    }
                },
                
                register: function() {
                    navigator.serviceWorker.register('/sw.js')
                        .then(registration => {
                            this.registration = registration;
                            console.log('Service Worker registered');
                        })
                        .catch(error => {
                            ErrorHandler.log(error, 'ServiceWorker', 'warn');
                        });
                }
            };

            // Offline Manager with IndexedDB caching
            const OfflineManager = {
                db: null,
                isOnline: navigator.onLine,
                
                init: function() {
                    this.setupListeners();
                    this.initDB();
                },
                
                setupListeners: function() {
                    window.addEventListener('online', () => {
                        this.isOnline = true;
                        this.hideOfflineIndicator();
                        this.syncOfflineData();
                    });
                    
                    window.addEventListener('offline', () => {
                        this.isOnline = false;
                        this.showOfflineIndicator();
                    });
                },
                
                initDB: function() {
                    if (!('indexedDB' in window)) return;
                    
                    const request = indexedDB.open('JaysMobileWashDB', 1);
                    
                    request.onerror = () => {
                        ErrorHandler.log('IndexedDB error', 'OfflineManager', 'warn');
                    };
                    
                    request.onsuccess = (event) => {
                        this.db = event.target.result;
                    };
                    
                    request.onupgradeneeded = (event) => {
                        const db = event.target.result;
                        
                        if (!db.objectStoreNames.contains('cache')) {
                            db.createObjectStore('cache', { keyPath: 'url' });
                        }
                        
                        if (!db.objectStoreNames.contains('offlineQueue')) {
                            db.createObjectStore('offlineQueue', { autoIncrement: true });
                        }
                    };
                },
                
                cacheResource: function(url, data) {
                    if (!this.db) return;
                    
                    const transaction = this.db.transaction(['cache'], 'readwrite');
                    const store = transaction.objectStore('cache');
                    
                    store.put({
                        url: url,
                        data: data,
                        timestamp: Date.now()
                    });
                },
                
                getCachedResource: function(url) {
                    return new Promise((resolve, reject) => {
                        if (!this.db) {
                            reject('Database not available');
                            return;
                        }
                        
                        const transaction = this.db.transaction(['cache'], 'readonly');
                        const store = transaction.objectStore('cache');
                        const request = store.get(url);
                        
                        request.onsuccess = () => {
                            resolve(request.result);
                        };
                        
                        request.onerror = () => {
                            reject('Cache read error');
                        };
                    });
                },
                
                showOfflineIndicator: function() {
                    const indicator = document.querySelector('.offline-indicator');
                    if (indicator) {
                        indicator.classList.add('show');
                    }
                },
                
                hideOfflineIndicator: function() {
                    const indicator = document.querySelector('.offline-indicator');
                    if (indicator) {
                        indicator.classList.remove('show');
                    }
                },
                
                syncOfflineData: function() {
                    // Sync any queued actions when back online
                    if (!this.db) return;
                    
                    const transaction = this.db.transaction(['offlineQueue'], 'readwrite');
                    const store = transaction.objectStore('offlineQueue');
                    const request = store.getAll();
                    
                    request.onsuccess = () => {
                        const queue = request.result;
                        queue.forEach(item => {
                            // Process queued items
                            console.log('Syncing offline data:', item);
                        });
                        
                        // Clear queue after processing
                        store.clear();
                    };
                }
            };

            // Lazy Load Manager using Intersection Observer
            const LazyLoadManager = {
                observer: null,
                elementsToObserve: new Set(),
                
                init: function() {
                    if (!('IntersectionObserver' in window)) {
                        // Fallback: load everything immediately
                        this.loadAllImmediately();
                        return;
                    }
                    
                    const options = {
                        root: null,
                        rootMargin: '50px',
                        threshold: 0.01
                    };
                    
                    this.observer = new IntersectionObserver(this.handleIntersection.bind(this), options);
                    this.observeElements();
                },
                
                observeElements: function() {
                    // Observe service cards
                    document.querySelectorAll('.service-card').forEach(card => {
                        this.observer.observe(card);
                        this.elementsToObserve.add(card);
                    });
                    
                    // Observe sections
                    document.querySelectorAll('section').forEach(section => {
                        this.observer.observe(section);
                        this.elementsToObserve.add(section);
                    });
                },
                
                handleIntersection: function(entries) {
                    entries.forEach(entry => {
                        if (entry.isIntersecting) {
                            const element = entry.target;
                            
                            // Trigger animations when in view
                            element.style.opacity = '1';
                            element.style.transform = 'translateY(0)';
                            
                            // Load any lazy content
                            const lazyImages = element.querySelectorAll('img[data-src]');
                            lazyImages.forEach(img => {
                                img.src = img.dataset.src;
                                img.removeAttribute('data-src');
                            });
                            
                            // Stop observing once loaded
                            this.observer.unobserve(element);
                            this.elementsToObserve.delete(element);
                        }
                    });
                },
                
                loadAllImmediately: function() {
                    // Fallback for older browsers
                    document.querySelectorAll('img[data-src]').forEach(img => {
                        img.src = img.dataset.src;
                        img.removeAttribute('data-src');
                    });
                },
                
                cleanup: function() {
                    if (this.observer) {
                        this.observer.disconnect();
                    }
                    this.elementsToObserve.clear();
                }
            };

            // Memory Manager for garbage collection
            const MemoryManager = {
                cleanupInterval: null,
                
                init: function() {
                    // Run cleanup every 30 seconds
                    this.cleanupInterval = setInterval(() => {
                        this.performCleanup();
                    }, 30000);
                },
                
                performCleanup: function() {
                    // Clean up expired timers
                    activeTimers.forEach(timer => {
                        if (!timer) {
                            activeTimers.delete(timer);
                        }
                    });
                    
                    // Clean up inactive particles
                    if (ParticleSystem.particles) {
                        const activeCount = ParticleSystem.particles.filter(p => p.active).length;
                        if (activeCount === 0 && ParticleSystem.particles.length > 0) {
                            ParticleSystem.cleanup();
                        }
                    }
                    
                    // Clean up cached resources older than 1 hour
                    if (OfflineManager.db) {
                        const transaction = OfflineManager.db.transaction(['cache'], 'readwrite');
                        const store = transaction.objectStore('cache');
                        const request = store.getAll();
                        
                        request.onsuccess = () => {
                            const now = Date.now();
                            const oneHour = 60 * 60 * 1000;
                            
                            request.result.forEach(item => {
                                if (now - item.timestamp > oneHour) {
                                    store.delete(item.url);
                                }
                            });
                        };
                    }
                    
                    // Force garbage collection if available (Chrome DevTools)
                    if (window.gc) {
                        window.gc();
                    }
                },
                
                destroy: function() {
                    if (this.cleanupInterval) {
                        clearInterval(this.cleanupInterval);
                    }
                }
            };

            // Initialize everything when DOM is ready
            if (document.readyState === 'loading') {
                document.addEventListener('DOMContentLoaded', ErrorHandler.wrap(() => {
                    LoadingModule.init();
                    MemoryManager.init();
                }, 'DOMContentLoaded'));
            } else {
                LoadingModule.init();
                MemoryManager.init();
            }

            // Clean up on page unload
            window.addEventListener('beforeunload', () => {
                // Clear all timers
                activeTimers.forEach(timer => clearInterval(timer));
                activeTimers.clear();
                
                // Disconnect observers
                observerManager.destroyAll();
                LazyLoadManager.cleanup();
                
                // Clean up memory
                MemoryManager.destroy();
                
                // Close audio context
                if (ParticleSystem.audioContext) {
                    ParticleSystem.audioContext.close();
                }
            });

            // Export for debugging
            window.JaysMobileWash = {
                ErrorHandler,
                LoadingModule,
                ParticleSystem,
                McLarenInteractions,
                ServiceWorkerManager,
                OfflineManager,
                LazyLoadManager,
                MemoryManager,
                performance: performanceData
            };

        })();
    </script>
</body>
</html>
